{% extends 'base.html' %}

{% block title %}{{ conductor.nombre_completo }} - Conductor{% endblock %}

{% block content %}
<div class="page-header" data-aos="fade-down">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1 class="page-title">Perfil del Conductor</h1>
            <p class="page-subtitle">Información detallada y estadísticas</p>
        </div>
        <div class="d-flex gap-2">
            <a href="{% url 'conductores_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
            <a href="{% url 'editar_conductor' conductor.id %}" class="btn btn-modern btn-warning">
                <i class="bi bi-pencil"></i> Editar
            </a>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Columna Izquierda: Información del Conductor -->
    <div class="col-lg-4">
        <!-- Card de Perfil -->
        <div class="modern-card text-center" data-aos="fade-up">
            <div style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4);">
                <i class="bi bi-person" style="font-size: 60px; color: white;"></i>
            </div>
            
            <h3 style="font-weight: 700; color: #0f172a; margin-bottom: 8px;">
                {{ conductor.nombre_completo }}
            </h3>
            
            <p style="color: #64748b; margin-bottom: 20px;">
                <i class="bi bi-person-badge"></i> Conductor Profesional
            </p>
            
            {% if conductor.activo %}
                <span class="badge" style="background: #10b981; font-size: 14px; padding: 8px 16px;">
                    <i class="bi bi-check-circle-fill"></i> Activo
                </span>
            {% else %}
                <span class="badge" style="background: #ef4444; font-size: 14px; padding: 8px 16px;">
                    <i class="bi bi-x-circle-fill"></i> Inactivo
                </span>
            {% endif %}
        </div>
        
        <!-- Card de Información de Contacto -->
        <div class="modern-card" data-aos="fade-up" data-aos-delay="100">
            <h5 style="font-weight: 700; color: #0f172a; margin-bottom: 20px;">
                <i class="bi bi-info-circle text-primary"></i> Información de Contacto
            </h5>
            
            <div class="mb-3">
                <label style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600;">Email</label>
                <p style="font-size: 14px; color: #0f172a; margin: 4px 0;">
                    <i class="bi bi-envelope text-primary"></i> {{ conductor.email }}
                </p>
            </div>
            
            <div class="mb-3">
                <label style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600;">Teléfono</label>
                <p style="font-size: 14px; color: #0f172a; margin: 4px 0;">
                    <i class="bi bi-telephone text-success"></i> {{ conductor.telefono|default:"No especificado" }}
                </p>
            </div>
            
            <div class="mb-3">
                <label style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600;">Documento</label>
                <p style="font-size: 14px; color: #0f172a; margin: 4px 0;">
                    <i class="bi bi-card-text text-warning"></i> {{ conductor.documento|default:"No especificado" }}
                </p>
            </div>
            
            <div>
                <label style="font-size: 12px; color: #64748b; text-transform: uppercase; font-weight: 600;">Fecha de Registro</label>
                <p style="font-size: 14px; color: #0f172a; margin: 4px 0;">
                    <i class="bi bi-calendar text-info"></i> {{ conductor.fecha_registro|date:"d/m/Y" }}
                </p>
            </div>
        </div>
        
        <!-- Card de Vehículo Asignado -->
        <div class="modern-card" data-aos="fade-up" data-aos-delay="200">
            <h5 style="font-weight: 700; color: #0f172a; margin-bottom: 20px;">
                <i class="bi bi-truck text-primary"></i> Vehículo Asignado
            </h5>
            
            {% if vehiculo %}
                <div style="background: #f8fafc; padding: 16px; border-radius: 12px;">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span style="font-weight: 600; font-size: 18px; color: #0f172a;">{{ vehiculo.placa }}</span>
                        <span class="badge" style="background: #3b82f6;">{{ vehiculo.get_estado_display }}</span>
                    </div>
                    <p style="font-size: 14px; color: #64748b; margin: 0;">
                        {{ vehiculo.marca }} {{ vehiculo.modelo }} ({{ vehiculo.anio }})
                    </p>
                    <p style="font-size: 13px; color: #64748b; margin-top: 8px;">
                        <i class="bi bi-box"></i> Capacidad: {{ vehiculo.capacidad_toneladas }} ton
                    </p>
                </div>
            {% else %}
                <div class="text-center" style="padding: 32px;">
                    <i class="bi bi-truck" style="font-size: 48px; color: #cbd5e1;"></i>
                    <p style="color: #64748b; margin-top: 12px;">Sin vehículo asignado</p>
                </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Columna Derecha: Estadísticas y Envíos -->
    <div class="col-lg-8">
        <!-- Estadísticas -->
        <div class="row g-4 mb-4">
            <div class="col-md-4" data-aos="fade-up">
                <div class="modern-card text-center">
                    <div style="font-size: 48px; font-weight: 700; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {{ total_envios }}
                    </div>
                    <p style="color: #64748b; margin: 8px 0 0 0; font-weight: 600;">Total Envíos</p>
                </div>
            </div>
            
            <div class="col-md-4" data-aos="fade-up" data-aos-delay="100">
                <div class="modern-card text-center">
                    <div style="font-size: 48px; font-weight: 700; background: linear-gradient(135deg, #10b981 0%, #059669 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {{ envios_completados }}
                    </div>
                    <p style="color: #64748b; margin: 8px 0 0 0; font-weight: 600;">Completados</p>
                </div>
            </div>
            
            <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
                <div class="modern-card text-center">
                    <div style="font-size: 48px; font-weight: 700; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        {{ envios_en_ruta }}
                    </div>
                    <p style="color: #64748b; margin: 8px 0 0 0; font-weight: 600;">En Ruta</p>
                </div>
            </div>
        </div>
        
        <!-- Historial de Envíos -->
        <div class="modern-card" data-aos="fade-up">
            <h5 style="font-weight: 700; color: #0f172a; margin-bottom: 20px;">
                <i class="bi bi-clock-history text-primary"></i> Historial de Envíos Recientes
            </h5>
            
            {% if envios %}
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead style="background: #f8fafc;">
                            <tr>
                                <th style="font-weight: 600; font-size: 14px; color: #475569;">Guía</th>
                                <th style="font-weight: 600; font-size: 14px; color: #475569;">Cliente</th>
                                <th style="font-weight: 600; font-size: 14px; color: #475569;">Ruta</th>
                                <th style="font-weight: 600; font-size: 14px; color: #475569;">Estado</th>
                                <th style="font-weight: 600; font-size: 14px; color: #475569;">Fecha</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for envio in envios %}
                            <tr>
                                <td>
                                    <span style="font-weight: 600; color: #0f172a;">{{ envio.numero_guia }}</span>
                                </td>
                                <td>{{ envio.cliente.nombre_completo }}</td>
                                <td style="font-size: 13px;">
                                    <div><i class="bi bi-geo-alt text-success"></i> {{ envio.origen|truncatewords:2 }}</div>
                                    <div><i class="bi bi-geo-alt-fill text-danger"></i> {{ envio.destino|truncatewords:2 }}</div>
                                </td>
                                <td>
                                    {% if envio.estado == 'en_ruta' %}
                                        <span class="badge" style="background: #3b82f6;">En Ruta</span>
                                    {% elif envio.estado == 'entregado' %}
                                        <span class="badge" style="background: #10b981;">Entregado</span>
                                    {% elif envio.estado == 'pendiente' %}
                                        <span class="badge" style="background: #f59e0b;">Pendiente</span>
                                    {% else %}
                                        <span class="badge" style="background: #64748b;">{{ envio.get_estado_display }}</span>
                                    {% endif %}
                                </td>
                                <td style="font-size: 13px; color: #64748b;">
                                    {{ envio.fecha_creacion|date:"d/m/Y" }}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="text-center" style="padding: 48px;">
                    <i class="bi bi-inbox" style="font-size: 64px; color: #cbd5e1;"></i>
                    <p style="color: #64748b; margin-top: 16px;">No hay envíos registrados para este conductor</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}
